
SELECT DISTINCT
	IFNULL(SSC.CONTACT_ID, SFPE.EMPLOYEE_ID)::BIGINT						AS DEBTORS_CREDITORS_ID
	, CUSTOMER_NUMBER								 						AS DEBTORS_CREDITORS_NUMBER
	, IFNULL(SSC.CONTACT_NAME, SFPE.EMPLOYEE_NAME)							AS DEBTORS_CREDITORS_NAME
	, CONTACT_NAME_SECONDARY												AS DEBTORS_CREDITORS_NAME_SECONDARY
	, IFNULL(SSC.CATEGORY, 'Supplier')										AS RELATIONSHIP_TYPE
	, SSC.BANK_IBAN															AS IBAN
	, SSC.BIC_NUMBER														AS BIC
FROM {{ ref('staging_sevdesk_contacts') }} ssc
FULL JOIN {{ ref('staging_flatfiles_personnel_expenses') }} SFPE ON SSC.CONTACT_NAME = SFPE.EMPLOYEE_NAME
