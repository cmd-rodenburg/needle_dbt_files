SELECT
	DATE 					::DATE					AS DATE_KEY
	, TRIM(INVOICE_NUMBER)							AS INVOICE_NUMBER
	, CONTRA_ACCOUNT								AS CUSTOMER_ID
	, COMPANY_NAME									AS INVOICE_NAME
	, ROUND(DEBIT, 2) 		::NUMERIC(10,2)			AS TOTAL_DEBIT
	, ROUND(CREDIT, 2)		::NUMERIC(10,2)			AS TOTAL_CREDIT
	, ACCOUNT_NUMBER
	, CASE
		WHEN ACCOUNT_NUMBER	IN (8000,8400,8336,8338,8340,8349,8736)	THEN 'SaaS'
		WHEN ACCOUNT_NUMBER	IN (8202,8351,8402)						THEN 'Onboarding'
		WHEN ACCOUNT_NUMBER	IN (8203,8403)							THEN 'Marketplace'
		WHEN ACCOUNT_NUMBER	IN (8201, 8401) 						THEN 'Projects'
		ELSE 'Other'
	END												AS REVENUE_CATEGORY
from {{ source('flatfiles', 'revenue_booked') }} br
WHERE BR.CONTRA_ACCOUNT != 1200
	AND BR.CONTRA_ACCOUNT NOT BETWEEN 8400 AND 8403